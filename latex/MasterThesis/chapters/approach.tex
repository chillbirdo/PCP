\begin{algorithm}[h]
\KwIn{An uncolored Graph $G=(V,E)$, a recoloring-algorithm $RECOLOR$ }
\KwOut{A feasible Solution $S$}
Set $S \gets OneStepCD(G)$\;
Set $cmax \gets$ the chromatic number of $S$\;
Set $X \gets \emptyset $\;
\For{$c=1,\ldots,cmax$}{
  Let $V_c$ be the set of nodes coloured by the colour $c$\;
  Uncolor all nodes in $V_c$\;
  $S_c \gets RECOLOR(V_c, cmax-1)$\;
  Let $C$ be the set of all nodes involved in color conflicts of $S_c$\;
  $X \gets X \cup (S_c,V_c,C_c)$
}
Sort $X$ ascendingly by $|C_c|$\;
Set $reduction \gets$ false\;
\For {$(S_c,V_c,C_c) \in X$}{
  $S_c' \gets TabuSearch(S_c, V_c, C_c)$\;
  \If{ $S_c'$ is free of conflicts}{
    $reduction \gets$ true\;
    break;
  }
}
\If{$reduction$}{
  $S \gets S_c$\;
  $cmax = cmax - 1$\;
  \textbf{goto} line 3;
}
\Return{$S$}\;
\caption{PCP Hybrid}
\label{algo:overall}
\end{algorithm}



\section{Constructional Heuristics}

\begin{algorithm}[h]
\KwIn{An uncolored Graph $G=(V,E)$}
\KwOut{A feasible Coloring $V'$}
Remove from G all edges $(i,j) \in E$ : $i,j \in V_k$ for some $k=1,\ldots,q$\; 
Set $V' \gets \emptyset $\;
\While{$|V'| < q$} {
  Set $X \gets \emptyset $\;
  \For{$k=1,\ldots,q$ : $V_k \cap V'=0$}{
    Set $X \gets X \cup argmin\{CD(i) : i \in V_k\}$\; 
  }
  Set $x \gets argmax\{CD(i) : i \in X \}$\;
  Set $V' \gets V' \cup \{x\}$\;
  Assign the minimum possible colour to x\;
  Remove from G all nodes in $V_{c(x)} \setminus \{x\} $\;
}
\Return{$V'$}\;
\caption{OneStepCD}
\label{algo:osdc}
\end{algorithm}


\section{Recoloring}\label{sec:recoloring}

\subsection{Random}
\subsection{OneStepCD}

\begin{algorithm}[h]
\KwIn{A partial Solution $P$, a number of maximum colours $cmax$ }
\KwOut{A feasible Solution $S$}
Let $U$ be the set of uncolored nodes in $P$\;
Set $S \gets \emptyset$\;
\While{$|U| > 0$} {
  Set $X \gets \emptyset $\;
  \For{ $u \in U$}{
    $X \gets X \cup argmin\{CD(i) : i \in V_{c(u)}\}$\; 
  }
  Set $x \gets argmax\{CD(i) : i \in X \}$\;
  Set $cmin \gets$ the minimum possible colour that can be assigned to x\;
  \If{$cmin \geq cmax$}{
    $cmin \gets$ the color that produces the fewest conflicts.
  }
  Assign $cmin$ to $x$\;
  $S \gets S \cup \{x\}$\;
  $U \gets U \setminus V_{c(x)}$\;
}
\Return{$V'$}\;
\caption{OneStepCD Recoloring}
\label{algo:osdc2}
\end{algorithm}

\clearpage

\subsection{ILP minimizing conflicts}

Let $Q = {Q_1,\ldots,Q_q}$ be the set of Clusters. Every cluster $Q_p$ consists of a set of nodes. Let $C=\{1,\ldots,cmax\}$ be the
set of allowed colors. Let $M$ be a 3-dimensional array of constants, storing
for every cluster $p \in Q$, the number conflicts that would occur by selecting the pair $(v \in Q_p, c \in C)$.
$E$ denotes the set of edges and $P[v]$ the cluster of node $v$.

\begin{equation*}[h]
\begin{aligned}
& \underset{X}{\text{minimize}} && \sum_{p \in Q}\sum_{v \in Q_p}\sum_{c \in C} X_{pvc} * M_{pvc}                    &&&(1)\\
& \text{subject to} && \sum_{v \in Q_p}\sum_{c \in C} X_{pvc}=1, && \forall p \in Q    &(2)\\
&&& X_{pvc}+X_{quc} \leq 1, && \forall ((p,v),(q,u)) \in E, \forall c \in C     &(3)\\
&&& X_{pvc} \in \{0,1\}, && \forall p \in Q, \forall v \in Q_p, \forall c \in C         &(4)
\end{aligned}
\end{equation*}


\subsection{ILP minimizing conflicting nodes}

Let $U$ be the set of uncolored nodes in uncolored clusters and $color[(p,v)]$ the color of the node $v$ in partition $p$.

\begin{equation*}[h]
\begin{aligned}
& \underset{Z}{\text{minimize}} && \sum_{p \in Q}\sum_{v \in Q_p}\sum_{c \in C} Z_{pvc}                                              &&&(1)\\
& \text{subject to} && Z_{pvc} \geq X_{quc}, && \forall ((p,v),(q,u))\in E : (p,v) \notin U, (q,u) \in U, c=color[(p,v)]                                                            &(2)\\
&&& \sum_{v \in Q_p}\sum_{c \in C} X_{pvc}=1, && \forall p \in Q   &(3)\\
&&& X_{pvc}+X_{quc} \leq 1, && \forall ((p,v),(q,u)) \in E, \forall c \in C     &(4)\\
&&& X_{pvc} \in \{0,1\}, && \forall p \in Q, \forall v \in Q_p, \forall c \in C        &(5)
\end{aligned}
\end{equation*}


\section{Tabu Search}

\begin{algorithm}[h]
\KwIn{An infeasible solution $S$, the set of previously recolored nodes $R$, the set of conflicting nodes $C$}
\KwOut{A Solution $\bar{S}$}
Set $C \gets C \setminus R$\;
Set $cmax \gets$ the chromatic number of $S$\;
Set $iter \gets 0$\;
Set $minConflicts \gets \infty$\;
Set $\bar{S} \gets S$\;
\While{$|C|>0$ and $iter < maxiter$}{
  \For{$V_{c(u)} : u \in C$}{
    \For{$v \in V_{c(u)}$ and \textbf{for} $c = 1,\ldots,cmax$}{
      Obtain a tentative solution $S'$ by selecting and coloring node v with color c in $\bar{S}$\; 
      \If{$conflicts(S') = 0$}{
          $\bar{S} \gets S', \bar{v} \gets v, \bar{c} \gets c$\;
          goto line 16\;
      }
      \ElseIf{the pair $v,c$ is not in the tabu list}{
        \If{$conflicts(S') < minConflicts$}{
          $minConflicts \gets conflicts(S')$\;
          $\bar{S} \gets S', \bar{v} \gets v, \bar{c} \gets c$\;
        }
      }
    }
  }
    insert pair $\bar{v}$, $\bar{c}$ in the tabu list for TabuTenure iterations\;
    $C \gets C \setminus u$\;
    Let $C_{\bar{v}}$ be the set of nodes conflicting with $\bar{v}$\;
    $C \gets C \cup C_{\bar{v}}$\;
}

\Return{$\bar{S}$}\;
\caption{TabuSearch}
\label{algo:tabusearch}
\end{algorithm}

\section{Variants}\label{sec:variants}

